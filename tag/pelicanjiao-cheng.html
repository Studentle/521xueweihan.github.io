<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <title>削微寒 - pelican教程</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">削微寒 </a></h1>
                <nav><ul>
                    <li><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/pelican.html">测试页面</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-02-28T00:00:00+08:00">
                Published: 日 28 二月 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/xueweihan.html">xueweihan</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>
<p>tags: <a href="/tag/pelicanjiao-cheng.html">pelican教程</a> </p>
</footer><!-- /.post-info --><h1>pelican</h1>
<p>Pelican Static Site Generator, Powered by Python：Pelican是python语言写的静态网站生成器。因为我一直打算用github pages做一个博客，现在已经学会用Hexo在github pages上做博客了。但是我一想：我一个pythoner，干嘛不用python写的静态网站生成器。我想应该是网上教程太少，那我今天就来搞一搞。顺便记录下来，整理出一个教程，希望一切顺利！</p>
<hr />
<h2>开始</h2>
<p>1.首先用virtualenv创建一个env</p>
<div class="highlight"><pre><span></span>mkdir blog
cd blog
virtualenv env
source env/bin/activate  #激活环境
</pre></div>


<p>2.使用pip安装pelican和markdown</p>
<div class="highlight"><pre><span></span>pip install pelican
pip install markdown
</pre></div>


<p>3.创建pelican目录结构</p>
<div class="highlight"><pre><span></span>pelican-quickstart
# 根据提示进行设置

&gt; Where do you want to create your new web site? [.]
&gt; What will be the title of this web site? 削微寒
&gt; Who will be the author of this web site? xueweihan
&gt; What will be the default language of this web site? [en] zh
&gt; Do you want to specify a URL prefix? e.g., http://example.com   (Y/n)
&gt; What is your URL prefix? (see above example; no trailing slash) xueweihan.com
&gt; Do you want to enable article pagination? (Y/n)
&gt; How many articles per page do you want? [10]
&gt; What is your time zone? [Europe/Paris] Asia/Shanghai
&gt; Do you want to generate a Fabfile/Makefile to automate generation and publishing? (Y/n)
&gt; Do you want an auto-reload &amp; simpleHTTP script to assist with theme and site development? (Y/n)
&gt; Do you want to upload your website using FTP? (y/N) n
&gt; Do you want to upload your website using SSH? (y/N) n
&gt; Do you want to upload your website using Dropbox? (y/N) n
&gt; Do you want to upload your website using S3? (y/N) n
&gt; Do you want to upload your website using Rackspace Cloud Files? (y/N) n
&gt; Do you want to upload your website using GitHub Pages? (y/N)
Done. Your new project is available at /Users/xueweihan/Documents/blog
</pre></div>


<p>文件结构如下：</p>
<div class="highlight"><pre><span></span>blog/
├── content              # 写的文章放这里
├── output               # 生成的输出文件（发布的内容）
├── develop_server.sh    
├── Makefile             # 方便管理博客的Makefile
├── pelicanconf.py       # 主配置文件
└── publishconf.py
</pre></div>


<p>我们下面只用到我解释的这几个目录和文件，大致有个印象即可</p>
<p>4.编写文章测试下效果</p>
<div class="highlight"><pre><span></span><span class="n">Date</span><span class="o">:</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span>
<span class="n">Title</span><span class="o">:</span> <span class="err">测试</span>
<span class="n">Tags</span><span class="o">:</span> <span class="err">测试</span>
<span class="n">Slug</span><span class="o">:</span> <span class="n">test</span>

<span class="err">#</span> <span class="n">pelican</span>
<span class="n">Pelican</span> <span class="n">Static</span> <span class="n">Site</span> <span class="n">Generator</span><span class="o">,</span> <span class="n">Powered</span> <span class="n">by</span> <span class="n">Python</span><span class="err">：</span><span class="n">Pelican</span><span class="err">是</span><span class="n">python</span><span class="err">语言写的静态网站生成器。因为我一直打算用</span><span class="n">git</span> <span class="n">pages</span><span class="err">做一个博客，现在已经学会用</span><span class="n">Hexo</span><span class="err">在</span><span class="n">git</span> <span class="n">pages</span><span class="err">上做博客了。但是我还是一想：我一个</span><span class="n">pythoner</span><span class="err">，干嘛不用</span><span class="n">python</span><span class="err">写的静态网站生成器。应该是网上教程太少，那我今天就来搞一搞。顺便记录下来，整理出一个教程，希望一切顺利！</span>
</pre></div>


<p>在content目录下创建一个名为：test.md的markdown文件，把上面的那些内容放进去，用来测试效果。</p>
<p>5.本地查看效果</p>
<div class="highlight"><pre><span></span># 在blog目录下执行
pelican content # 根据content中的内容，生成静态网站到output目下

# 在output目录下执行
python -m pelican.server
</pre></div>


<p>以上两个命令执行完，没有报错的话就用浏览器打开：127.0.0.1:8000，效果如下：</p>
<p><img alt="" src="http://7xqirw.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-02-28%20%E4%B8%8B%E5%8D%885.18.31.png" title="本地效果" /></p>
<p>输入：<code>ctrl + c</code> 停止服务</p>
<p>5.上传到github pages 现在就差最后一步，上传到github pages上面。 一步步的来：</p>
<p>首先在github上创建一个项目，<code>Repository name</code>填写：你的github用户名.github.io 如下图：</p>
<p><img alt="" src="http://7xqirw.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-02-28%20%E4%B8%8B%E5%8D%885.25.05.png" title="github 创建仓库" /></p>
<p>然后在<code>output</code>目录依次输入：</p>
<div class="highlight"><pre><span></span>git init
git add .
git commit -m &quot;pelican static blog test&quot;
git remote add origin git@github.com:你的github用户名/你的github用户名.github.io.git
# 例如我的就是：git@github.com:521xueweihan/521xueweihan.github.io.git
git push -u origin master
</pre></div>


<p>最后访问：<a href="http://你的github用户名.github.io/">http://你的github用户名.github.io/</a> 例如我的就是：<a href="http://521xueweihan.github.io/">http://521xueweihan.github.io/</a></p>
<p>页面如下图： <img alt="" src="http://7xqirw.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-02-28%20%E4%B8%8B%E5%8D%885.42.10.png" title="github pages 上效果" /></p>
<h2>简化发布流程</h2>
<p>还记得Makefile文件吗？我们通过修改这个文件，实现1条指令发布博客到github pages上。</p>
<p>把<code>blog</code>目录下的Makefile文件中的内容替换成下面的内容(原Makefile文件的内容都不要)</p>
<div class="highlight"><pre><span></span>PY?<span class="o">=</span>python
PELICAN?<span class="o">=</span>pelican
<span class="nv">PELICANOPTS</span><span class="o">=</span>

<span class="nv">BASEDIR</span><span class="o">=</span><span class="k">$(</span>CURDIR<span class="k">)</span>
<span class="nv">INPUTDIR</span><span class="o">=</span><span class="k">$(</span>BASEDIR<span class="k">)</span>/content
<span class="nv">OUTPUTDIR</span><span class="o">=</span><span class="k">$(</span>BASEDIR<span class="k">)</span>/output
<span class="nv">CONFFILE</span><span class="o">=</span><span class="k">$(</span>BASEDIR<span class="k">)</span>/pelicanconf.py


RELATIVE ?<span class="o">=</span> 0
ifeq <span class="o">(</span><span class="k">$(</span>RELATIVE<span class="k">)</span>, 1<span class="o">)</span>
    PELICANOPTS +<span class="o">=</span> --relative-urls
endif

help:
    @echo <span class="s1">&#39;Makefile for a pelican Web site                                           &#39;</span>
    @echo <span class="s1">&#39;                                                                          &#39;</span>
    @echo <span class="s1">&#39;Usage:                                                                    &#39;</span>
    @echo <span class="s1">&#39;   make html                           (re)generate the web site          &#39;</span>
    @echo <span class="s1">&#39;   make clean                          remove the generated files         &#39;</span>
    @echo <span class="s1">&#39;   make regenerate                     regenerate files upon modification &#39;</span>
    @echo <span class="s1">&#39;   make serve [PORT=8000]              serve site at http://localhost:8000&#39;</span>
    @echo <span class="s1">&#39;   make stopserver                     stop local server                  &#39;</span>

html:
    <span class="k">$(</span>PELICAN<span class="k">)</span> <span class="k">$(</span>INPUTDIR<span class="k">)</span> -o <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> -s <span class="k">$(</span>CONFFILE<span class="k">)</span> <span class="k">$(</span>PELICANOPTS<span class="k">)</span>

clean:
    <span class="o">[</span> ! -d <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> <span class="o">]</span> <span class="o">||</span> rm -rf <span class="k">$(</span>OUTPUTDIR<span class="k">)</span>

regenerate:
    <span class="k">$(</span>PELICAN<span class="k">)</span> -r <span class="k">$(</span>INPUTDIR<span class="k">)</span> -o <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> -s <span class="k">$(</span>CONFFILE<span class="k">)</span> <span class="k">$(</span>PELICANOPTS<span class="k">)</span>

serve:
ifdef PORT
    <span class="nb">cd</span> <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> <span class="o">&amp;&amp;</span> <span class="k">$(</span>PY<span class="k">)</span> -m pelican.server <span class="k">$(</span>PORT<span class="k">)</span>
<span class="k">else</span>
    <span class="nb">cd</span> <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> <span class="o">&amp;&amp;</span> <span class="k">$(</span>PY<span class="k">)</span> -m pelican.server
endif

stopserver:
    <span class="k">$(</span>BASEDIR<span class="k">)</span>/develop_server.sh stop
    @echo <span class="s1">&#39;Stopped Pelican and SimpleHTTPServer processes running in background.&#39;</span>

publish:
    <span class="k">$(</span>PELICAN<span class="k">)</span> <span class="k">$(</span>INPUTDIR<span class="k">)</span> -o <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> -s <span class="k">$(</span>CONFFILE<span class="k">)</span> <span class="k">$(</span>PELICANOPTS<span class="k">)</span>

github: publish
    <span class="nb">cd</span> <span class="k">$(</span>OUTPUTDIR<span class="k">)</span> <span class="p">;</span> git add . <span class="p">;</span>  git commit -am <span class="s1">&#39;更新博客&#39;</span> <span class="p">;</span> git push

.PHONY: html <span class="nb">help</span> clean regenerate serve github
</pre></div>


<p><strong>更新博客流程</strong>
1. 我们把写好的markdown格式的文章放到content中，然后在<code>blog</code>目录下
2. 本地查看效果的话：<code>make html</code> 然后<code>make serve</code> 最后访问：127.0.0.1:8000
3. 发布到github：<code>make github</code> 完成</p>
<h2>未完待续</h2>
<ul>
<li>独立域名</li>
<li>主题</li>
<li>结构</li>
<li>follew me on the github</li>
<li>ico</li>
<li>rebot.txt</li>
<li>百度，google收录和分析</li>
</ul>
<h2>参考</h2>
<ul>
<li><a href="http://www.lizherui.com/pages/2013/08/17/build_blog.html">lizherui的博客</a></li>
<li><a href="http://docs.getpelican.com/en/3.5.0/quickstart.html">pelican官方文档</a></li>
<li><a href="https://pelican-zh.readthedocs.org/en/latest/zh-cn/">pelican中文文档（不全）</a></li>
<li><a href="http://www.jianshu.com/p/d80a5cefc128">Pelican搭建静态博客</a></li>
</ul>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>